<!DOCTYPE html>
<html>
<meta charset="utf-8">
<head>
	<title>Ebola in 2014</title>
	<script type="text/javascript" src="//use.typekit.net/xhb3qda.js"></script>
	<script type="text/javascript">try{Typekit.load();}catch(e){}</script>
	<style>
		html {
			background-attachment: fixed;
			background-image: url("vectorized-virion.svg");
			background-size: 200%;
			background-position: -190px -480px;
		}

		body {
			margin: 0;

			background: linear-gradient(to bottom, rgba(192, 221, 235, 0.75), rgba(192, 221, 235, 1));
			color: #333;
			font-family: freight-sans-pro, "Helvetica Neue", Helvetica, Arial, sans-serif;
			font-size: 24px;
			text-rendering: optimizeLegibility;
			-webkit-font-smoothing: antialiased;
		}

		a {
			color: rgba(29, 92, 122, 0.75);
			font-weight: 600;
			text-decoration: none;
		}

		a:hover,
		a:focus {
			color: rgba(197, 93, 34, 0.75);
		}

		.Container {
			width: 90%;
			max-width: 1024px;
			margin: 0 auto;
		}

		.Row {
			padding: 0 0 100px;
		}

		.Header {
			margin-bottom: -20px;
			padding: 40px 0 0;
			overflow: hidden;

			text-align: right;
		}

		.Headline {
			position: relative;

			display: inline-block;
			margin: 0 12px 0 0;
			padding: 24px 36px 0;

			color: rgba(57, 73, 82, 1);
			font-family: freight-big-pro, Georgia, "Times New Roman", serif;
			font-size: 120px;
			font-style: italic;
			font-weight: 900;
			line-height: 1;
			text-shadow: 0 1px 0 rgba(255,255,255,0.8);
			text-rendering: optimizeLegibility;

			font-style: normal;
			font-weight: 300;
		}

		.Subheading {
			margin-top: 0;
			margin-bottom: 24px;

			color: rgba(57, 73, 82, 1);
			font-family: freight-big-pro;
			font-size: 84px;
			font-weight: 400;
			text-align: center;
			text-shadow: 0 1px 0 rgba(255,255,255,0.6);
			text-rendering: optimizeLegibility;
		}

		.Kicker {
			position: relative;

			margin: 0 0 60px;

			font-size: 28px;
			line-height: 1.25;
		}

		.Kicker--backdrop {
			margin: 0;
			padding: 46px 0 46px;
		}

		.Kicker--backdrop:before {
			content: "";
			z-index: -1;
			position: absolute;
			top: -26px;
			right: -300px;
			bottom: -26px;
			left: -70px;

			display: block;

			background: rgba(255, 255, 255, 0.8);
			box-shadow: inset 0 -2px 0 #fff;
			transform: skew(-12.5deg);
		}

		.Chart {
			position: relative;

			margin: 0 0 30px;
			padding: 32px 0 42px;

			background: rgba(0,0,0,0.7);
			box-shadow: none;
		}

		.Chart svg {
			display: block;
			margin: 0 auto;

			fill: #fff;
			font-size: 16px;
			font-weight: 600;
			text-shadow: 0 -1px 0 rgba(0,0,0,0);
		}

		.axis path,
		.axis line {
			fill: none;
			shape-rendering: crispEdges;
		}

		.axis path {
			stroke: rgba(255,255,255,0.2);
		}

		.axis line {
			stroke: rgba(255,255,255,0.3);
		}

		.cases {
			fill: none;
			stroke: rgba(151, 197, 235, 1);
			stroke-width: 4px;
		}

		.deaths {
			fill: none;
			stroke: rgba(236, 120, 120, 1);
			stroke-width: 4px;
		}

		.textDeath {
			fill: rgba(236, 120, 120, 1);
			font-size: 18px;
			font-weight: 700;
			letter-spacing: 0.03em;
			stroke: none;
		}

		.textCases {
			fill: rgba(151, 197, 235, 1);
			font-size: 18px;
			font-weight: 700;
			letter-spacing: 0.03em;
			stroke: none;
		}

		.AngleBtn {
			position: relative;

			display: inline-block;
			padding: 0.9em 1.4em 1em;

			color: #524E41;
			font-size: 24px;
			font-weight: 900;
			letter-spacing: 0.03em;
			line-height: 1;
			text-decoration: none;
			text-transform: uppercase;
			text-shadow: 0 1px 0 rgba(255,255,255,0.6);
			text-rendering: optimizeLegibility;
		}

		.AngleBtn:hover,
		.AngleBtn:focus {
			color: #524E41;
		}

		.AngleBtn:before {
			content: "";

			position: absolute;
			top: 0;
			right: 0;
			bottom: 0;
			left: 0;

			display: block;
			border: 1px solid #9B8C48;
			border-top-color: #ACA796;

			background: #FFF0B2;
			background-image: linear-gradient(to bottom, rgba(255,255,255,0.4), rgba(255,255,255,0));
			box-shadow: 1px 1px 0px rgba(0,0,0,0.15);
			transform: skew(-13deg);
		}

		.AngleBtn:hover:before,
		.AngleBtn:focus:before {
			background: #FFF7D5;
		}

		.AngleBtn span {
			position: relative;
		}

		.Highlight {
			margin: 80px auto 0;
			padding-left: 0;
			padding: 24px 30px 28px;
			border: 1px solid rgba(97, 119, 129, 0.5);

			background-image: linear-gradient(to bottom, rgba(255,255,255,0.3), rgba(255,255,255,0));
			background-color: rgba(255,255,255,0.5);
			box-shadow: 0px 1px 1px rgba(0,0,0,0.1), inset 0 1px 0 #fff;
			color: rgba(0,0,0,0.6);
			font-size: 20px;
			font-weight: 500;
			line-height: 1;
		}

		.Highlight-list {
			margin: 0;
			padding-left: 20px;

			list-style: none;
		}

		.Highlight-list li {
			position: relative;
			margin-bottom: 16px;
		}

		.Highlight-list li:last-child {
			margin-bottom: 0;
		}

		.Highlight-list li:before {
			content: "";

			position: absolute;
			top: 7px;
			left: -20px;

			display: block;
			width: 4px;
			height: 4px;
			border: 1px solid rgba(0,0,0,0.4);
			border-radius: 50%;
		}

		.Footer {
			overflow: hidden;
			padding: 24px 0 48px;
			border-top: 1px solid rgba(157, 183, 197, 1);

			background: rgba(255,255,255,0.4);
			box-shadow: inset 0 1px 0 rgba(255,255,255,0.3);
			color: rgba(93, 102, 107, 1);
			text-align: center;
		}

		.SubtleHeading {
			margin: 0 0 36px;

			font-weight: 300;
			text-align: center;
		}

		.LogoList {
			margin: 0 0 60px;
			padding: 0;

			list-style: none;
			text-align: center;
		}

		.LogoList li {
			display: inline-block;
			margin-left: 60px;

			vertical-align: top;
		}

		.LogoList li:first-child {
			margin-left: 0;
		}

		.Logo-Polis {
			width: 200px;
		}

		.Logo-Formidable {
			position: relative;
			top: 12px;

			width: 336px;
		}

		.Social {
			margin-top: 5px;
		}

		.u-MiniCopy {
			margin: 0;

			font-size: 21px;
		}

		.u-NoMargin {
			margin: 0;
		}

		.u-Overflow {
			overflow: hidden;
		}

		.u-AlignCenter {
			text-align: center;
		}

		.u-AlignRight {
			text-align: right;
		}
	</style>
</head>
<body>

<header class="Header">
	<h1 class="Headline">Ebola in 2014</h1>
</header>

<div class="u-Overflow">
	<div class="Container">
		<div class="Kicker Kicker--backdrop">
			<p class="u-NoMargin">This site is auto updating. It is always based on <a href="http://healthmap.org/ebola/">the most recent data posted to healthmap.</a> We built it because we kept asking the questions: what's the rate of increase? Is it exponential? How do rates of new cases compare to deaths? These questions are at the heart of the story of Ebola, and need to be answered on a continual basis.</p>

			<div class="Social">
				<a href="https://twitter.com/share" class="twitter-share-button">Tweet</a>
				<iframe src="//www.facebook.com/plugins/like.php?href=https%3A%2F%2Fdevelopers.facebook.com%2Fdocs%2Fplugins%2F&amp;width&amp;layout=button_count&amp;action=recommend&amp;show_faces=true&amp;share=false&amp;height=21&amp;appId=130905330306774" scrolling="no" frameborder="0" style="border:none; overflow:hidden; height:21px;" allowTransparency="true"></iframe>
			</div>
		</div>
	</div>
</div>

<div class="Chart"></div>

<div class="Container Row">
	<h2 class="Subheading">How you can help</h2>

	<p class="Kicker">The United Nations World Food Program (WFP) is feeding people in quarantine zones. <a href="https://www.wfp.org/stories/wfp-response-ebola">They are presently scaling up their operations in affected regions</a> to serve over 1,000,000 human beings across 3 countries. Their efforts are critical in preventing a medical crisis from becoming a broader humanitarian crisis. Please help them help others.</p>

	<p class="u-AlignCenter">
		<a class="AngleBtn" href="https://give.wfp.org/en/?step=country">
			<span>Donate to WFP</span>
		</a>
	</p>

	<div class="Highlight">
		<ul class="Highlight-list">
			<li><a href="http://www.vox.com/cards/ebola-outbreak-2014/why-is-ebola-in-the-news">Find a comprehensive overview of the 2014 ebola outbreak @ vox.com</a></li>
			<li><a href="http://www.doctorswithoutborders.org/our-work/medical-issues/ebola">Learn about the efforts of MSF (Doctors Without Borders).</a></li>
			<li><a href="https://donate.doctorswithoutborders.org/onetime.cfm">Donate to the MSF (Doctors Without Borders) general fund, even though they are fully funded in their Ebola efforts in West Africa.</a></li>
			<li><a href="https://give.wfp.org/en/?step=country">Donate to WFP (World Food Program), which is feeding people in affected quarantine zones.</a></li>
			<li>The WHO warns that the crisis may be <a href="https://www.google.com/search?q=ebola+underestimate&oq=ebola+und&aqs=chrome.0.69i59j69i57j0l4.1300j0j7&sourceid=chrome&es_sm=91&ie=UTF-8#q=ebola+underestimate&tbm=nws">vastly underestimated.</a></li>
		</ul>
	</div>
</div>

<footer class="Footer">
	<div class="Container">
		<h2 class="SubtleHeading">Built by</h2>

		<ul class="LogoList">
			<li>
				<a href="http://pol.is">
					<img class="Logo Logo-Polis" src="assets/polis.png" alt="Polis">
				</a>
			</li>
			<li>
				<a href="http://formidablelabs.com">
					<img class="Logo Logo-Formidable" src="assets/formidable-labs.png" alt="Formidable Labs">
				</a>
			</li>
		</ul>

		<p class="u-MiniCopy">Biostatistician? Epidemiologist? Help us improve the site by submitting issues and pull requests on <a href="https://github.com/colinmegill/ebola">GitHub</a>.</p>
	</div>
</footer>






<!-- <script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script> -->
<script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/d3/3.4.11/d3.js"></script>
<script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/underscore.js/1.6.0/underscore-min.js"></script>
<script type="text/javascript" src="http://bit.ly/ss-js"></script>
<script type="text/javascript">

var margin = {top: 20, right: 20, bottom: 30, left: 50},
  width = 960 - margin.left - margin.right,
  height = 500 - margin.top - margin.bottom;

var parseDate = d3.time.format("%B %e").parse;

var x = d3.time.scale()
    .range([0, width]);

var y = d3.scale.linear()
    .range([height, 0]);

var xAxis = d3.svg.axis()
    .scale(x)
    .orient("bottom");

var yAxis = d3.svg.axis()
    .scale(y)
    .orient("left");

var casesLine = d3.svg.line()
    .x(function(d) { return x(d.date); })
    .y(function(d) { return y(d.cases); });

var deathLine = d3.svg.line()
    .x(function(d) { return x(d.date); })
    .y(function(d) { return y(d.deaths); });

var svg = d3.select(".Chart").append("svg")
    .attr("width", width + margin.left + margin.right)
    .attr("height", height + margin.top + margin.bottom)
  	.append("g")
    .attr("transform", "translate(" + margin.left + "," + margin.top + ")");

svg.append("text")
	.attr("x", 50)
	.attr("y", "75%")
	.text("Deaths")
	.attr("class", "textDeath")

svg.append("text")
	.attr("x", 50)
	.attr("y", "70%")
	.text("Cases")
	.attr("class", "textCases")

function addAxis (data) {

  x.domain(d3.extent(data, function(d) { return d.date; }));
  y.domain(d3.extent(data, function(d) { return d.cases; }));

  svg.append("g")
      .attr("class", "x axis")
      .attr("transform", "translate(0," + height + ")")
      .call(xAxis);

  svg.append("g")
      .attr("class", "y axis")
      .call(yAxis)
    	.append("text")
      .attr("transform", "rotate(-90)")
      .attr("y", 6)
      .attr("dy", ".71em")
      .style("text-anchor", "end");
}


function addCasesLine (data) {

	  svg.append("path")
      .datum(data)
      .attr("class", "cases")
      .attr("d", casesLine);
}

function addDeathLine (data) {
		  svg.append("path")
      .datum(data)
      .attr("class", "deaths")
      .attr("d", deathLine)
}


function visualize (data) {

	 data = _.each(data, function(d){
  	d.date = parseDate(d.date);
  })

	addAxis(data);
	addCasesLine(data);
	addDeathLine(data)

};


function expFit(xys) {
  var xys_ = _.map(data, function(xy) {
      return [xy[0], Math.log(xy[1])]
      });
  var linFit = ss.linear_regression().data(xys_);
  var expFun = function(x) {
    return Math.exp(linFit.m() * x + linFit.b());
  };
  return expFun;
}


function fitData(data, variable) {
  var forFit = _.map(data, function(d) {
      return [d.date.vlaueOf(), d[variable]];
      });
  return expFit(forFit);
}


d3.json("/ebola", function(error, json) {
  if (error) return console.warn(error);
  data = json;
  visualize(data);
  console.log(data)
});

</script>
<script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>
</body>
</html>
